<!DOCTYPE html>
<html>

<head>
    <base href="/">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, viewport-fit=cover, initial-scale=1, maximum-scale=1.0, user-scalable=no, interactive-widget=resizes-content">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="darkreader-lock">
    <meta name="robots" content="noindex, nofollow" />
    <style>
        /* Put critical CSS here. The rest should go in stylesheets. */
        body {
            background-color: rgb(36, 36, 37);
        }

        /* 彻底防止横向滚动的紧急修复 */
        html, body {
            overflow-x: hidden !important;
            max-width: 100vw !important;
            width: 100vw !important;
            box-sizing: border-box !important;
        }

        * {
            max-width: 100vw !important;
            box-sizing: border-box !important;
        }

        /* 特殊处理可能导致滚动的元素 */
        #shadow_popup, #dialogue_popup {
            width: 100vw !important;
            max-width: 100vw !important;
            overflow-x: hidden !important;
            box-sizing: border-box !important;
        }
    </style>
    <link rel="preload" as="style" href="style.css">
    <link rel="apple-touch-icon" sizes="57x57" href="img/apple-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="img/apple-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="img/apple-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="img/apple-icon-144x144.png" />
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" type="text/css" href="css/st-tailwind.css">
    <link rel="stylesheet" type="text/css" href="css/login.css">
    <link rel="stylesheet" type="text/css" href="css/register.css">
    <link rel="manifest" crossorigin="use-credentials" href="manifest.json">
    <link href="webfonts/NotoSans/stylesheet.css" rel="stylesheet">
    <link href="webfonts/NotoSansMono/stylesheet.css" rel="stylesheet">
    <!-- fontawesome webfonts-->
    <link href="css/fontawesome.min.css" rel="stylesheet">
    <link href="css/solid.min.css" rel="stylesheet">
    <link href="css/user.css" rel="stylesheet">
    <title>SillyTavern - 用户注册</title>
</head>

<body class="login register-page">
    <div id="shadow_popup" style="opacity: 1;">
        <div id="dialogue_popup">
            <div id="dialogue_popup_holder">
                <div id="dialogue_popup_text">
                    <div id="registerBlock" class="register-container">
                        <div class="register-form-container">
                            <div class="register-header">
                                <h1 class="register-title">欢迎来到 SillyTavern</h1>
                                <p class="register-subtitle">创建您的账户，开始AI对话之旅</p>
                            </div>
                            <form id="registerForm" class="register-form">
                                <div class="form-group">
                                    <label for="displayName" class="form-label">显示名称</label>
                                    <input id="displayName" class="form-input" type="text" placeholder="请输入您的显示名称" autocomplete="name" required>
                                </div>

                                <div class="form-group">
                                    <label for="userHandle" class="form-label">用户名</label>
                                    <input id="userHandle" class="form-input" type="text" placeholder="仅限字母和数字，不允许符号" pattern="[a-z0-9]+" autocomplete="username" required>
                                    <small class="form-hint">例如：johndoe123（只能包含字母和数字）</small>
                                </div>

                                <div class="form-group">
                                    <label for="userPassword" class="form-label">密码</label>
                                    <input id="userPassword" class="form-input" type="password" placeholder="请输入密码" autocomplete="new-password" required>
                                    <small class="form-hint">密码长度至少6位</small>
                                </div>

                                <div class="form-group">
                                    <label for="confirmPassword" class="form-label">确认密码</label>
                                    <input id="confirmPassword" class="form-input" type="password" placeholder="请再次输入密码" autocomplete="new-password" required>
                                </div>

                                <div class="form-group" id="invitationCodeGroup" style="display: none;">
                                    <label for="invitationCode" class="form-label">邀请码</label>
                                    <input id="invitationCode" class="form-input" type="text" placeholder="请输入邀请码" autocomplete="off">
                                    <small class="form-hint">注册需要有效的邀请码</small>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" id="registerButton" class="btn btn-primary">创建账户</button>
                                    <button type="button" id="backToLoginButton" class="btn btn-secondary">返回登录</button>
                                </div>
                            </form>
                        </div>

                        <div id="errorMessage" class="error-message"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="lib/jquery-3.5.1.min.js"></script>
    <script>
        // 彻底防止横向滚动的JavaScript解决方案
        function preventHorizontalScroll() {
            // 强制设置body样式
            document.body.style.overflowX = 'hidden';
            document.body.style.maxWidth = '100vw';
            document.body.style.width = '100vw';
            document.body.style.boxSizing = 'border-box';

            // 强制设置html样式
            document.documentElement.style.overflowX = 'hidden';
            document.documentElement.style.maxWidth = '100vw';
            document.documentElement.style.width = '100vw';
            document.documentElement.style.boxSizing = 'border-box';

            // 检查并修复所有可能导致横向滚动的元素
            const elements = document.querySelectorAll('*');
            elements.forEach(el => {
                const rect = el.getBoundingClientRect();
                if (rect.width > window.innerWidth) {
                    el.style.maxWidth = '100vw';
                    el.style.width = '100%';
                    el.style.boxSizing = 'border-box';
                    el.style.overflowX = 'hidden';
                }
            });

            // 特别处理弹窗元素
            const popup = document.getElementById('dialogue_popup');
            if (popup) {
                popup.style.width = 'calc(100vw - 40px)';
                popup.style.maxWidth = 'calc(100vw - 40px)';
                popup.style.left = '20px';
                popup.style.right = '20px';
                popup.style.marginLeft = '0';
                popup.style.marginRight = '0';
                popup.style.boxSizing = 'border-box';
                popup.style.overflowX = 'hidden';
            }

            const shadowPopup = document.getElementById('shadow_popup');
            if (shadowPopup) {
                shadowPopup.style.width = '100vw';
                shadowPopup.style.maxWidth = '100vw';
                shadowPopup.style.overflowX = 'hidden';
                shadowPopup.style.left = '0';
                shadowPopup.style.right = '0';
            }
        }

        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', preventHorizontalScroll);

        // 窗口大小变化时重新执行
        window.addEventListener('resize', preventHorizontalScroll);

        // 定期检查（防止动态添加的元素）
        setInterval(preventHorizontalScroll, 1000);
    </script>
    <script src="scripts/register.js"></script>
</body>

</html>
